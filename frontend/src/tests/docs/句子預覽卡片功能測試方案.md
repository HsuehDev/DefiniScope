# 句子預覽卡片功能測試方案

## 1. 組件概述

SentencePreview組件是系統中用於顯示句子信息的核心展示組件，支持不同類型句子的顯示，包括以下功能：

- 顯示句子文本及其基本信息（頁碼、源文件）
- 根據定義類型（概念型/操作型）顯示不同風格
- 支持長句子的截斷處理
- 提供點擊交互功能
- 顯示相關度評分及分類理由（如有）
- 適應不同上下文的樣式定制

## 2. 測試需求

### 2.1 功能性測試

- 驗證句子文本、頁碼等基本信息正確顯示
- 確認不同定義類型對應的樣式正確設置
- 測試長句子的截斷邏輯是否正常運作
- 檢查點擊事件是否正確觸發
- 驗證根據數據類型顯示相應的附加信息（來源、相關度、分類理由）

### 2.2 視覺呈現測試

- 確保各種句子類型下的視覺樣式符合設計規範
- 驗證不同狀態間的樣式變化（如懸停效果）
- 檢查在不同數據量和屏幕尺寸下的自適應佈局

### 2.3 邊界條件測試

- 測試極短和超長句子的顯示效果
- 檢查缺少可選數據時的降級顯示
- 驗證異常數據輸入的錯誤處理機制

## 3. 測試用例設計

### 3.1 基本信息顯示測試

| 測試ID | 測試內容 | 預期結果 |
|--------|---------|----------|
| ST-101 | 基本句子信息顯示 | 句子文本和頁碼應正確顯示 |
| ST-102 | 文件來源顯示（ReferencedSentence類型） | 應顯示文件名 |
| ST-103 | 相關度評分顯示 | 應以百分比形式顯示 |

### 3.2 定義類型樣式測試

| 測試ID | 測試內容 | 預期結果 |
|--------|---------|----------|
| ST-201 | 概念型定義句子樣式 | 應顯示藍色邊框和標籤 |
| ST-202 | 操作型定義句子樣式 | 應顯示綠色邊框和標籤 |
| ST-203 | 非定義句子樣式 | 應顯示灰色邊框和標籤 |

### 3.3 內容格式處理測試

| 測試ID | 測試內容 | 預期結果 |
|--------|---------|----------|
| ST-301 | 長句子截斷測試（>150字符） | 應截斷並顯示省略號 |
| ST-302 | 短句子完整顯示測試 | 應完整顯示不截斷 |
| ST-303 | 分類理由顯示測試 | 應在句子下方顯示理由 |

### 3.4 交互功能測試

| 測試ID | 測試內容 | 預期結果 |
|--------|---------|----------|
| ST-401 | 點擊事件測試 | 應調用onClick回調函數 |
| ST-402 | 懸停狀態測試 | 應顯示陰影效果增強 |
| ST-403 | 禁用點擊時的交互測試 | 不應有手型光標和點擊效果 |

## 4. 測試實現方案

### 4.1 單元測試框架

使用Vitest + Testing Library實現測試，主要測試方式：

```typescript
// 示例測試代碼
it('應正確顯示基本句子信息', () => {
  render(<SentencePreview sentence={baseSentenceData} />);
  
  // 檢查句子內容和頁碼是否正確顯示
  expect(screen.getByTestId('sentence-text')).toHaveTextContent(baseSentenceData.sentence);
  expect(screen.getByTestId('sentence-page')).toHaveTextContent('頁碼: 5');
});
```

### 4.2 模擬數據準備

為測試準備三類基本數據：

1. 基本句子數據
2. 概念型/操作型定義句子數據
3. 引用型句子數據（含文件來源和相關度）

### 4.3 視覺測試

使用Storybook建立各種狀態的視覺樣本，包括：

1. 三種定義類型的句子卡片
2. 不同長度句子的顯示效果
3. 帶分類理由和不帶理由的對比
4. 帶來源信息和相關度的顯示效果

## 5. 性能測試考量

### 5.1 渲染性能

- 測試大量句子卡片（30+）同時渲染的性能表現
- 監測滾動時的幀率和響應速度

### 5.2 記憶體使用

- 監測長時間使用及數據刷新時的記憶體佔用情況
- 檢測是否存在記憶體洩漏問題

## 6. 測試覆蓋率目標

- 代碼覆蓋率：>90%
- 功能覆蓋率：100%（所有公開功能）
- 視覺狀態覆蓋率：>95%（所有可能的視覺狀態）

## 7. 自動化整合

- 集成到CI/CD流程中
- 每次提交自動運行單元測試
- 定期（週）進行視覺回歸測試
- 性能基準測試（月）

## 8. 測試報告規範

測試報告應包含：

- 功能測試覆蓋率與結果
- 失敗用例詳細分析
- 視覺測試比對結果
- 性能測試數據與趨勢
- 建議的改進項目 