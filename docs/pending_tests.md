# PDF渲染與高亮功能待測項目清單

以下是當前無法完成但必須進行測試的項目清單，記錄測試過程中發現的問題和待解決事項。

## 單元測試

### PDFViewer組件

1. **PDF載入與渲染測試**
   - 問題：PDFThumbnailSidebar組件在Array.from操作時出現"Invalid array length"錯誤
   - 原因：空數組或負值導致Array.from生成錯誤
   - 解決方向：已嘗試修復邊界情況檢查，但仍需更徹底測試

2. **頁面導航功能測試**
   - 問題：測試超時或因DOM事件處理出現錯誤
   - 解決方向：需要更好的event mocking或考慮使用測試特定版本的模擬組件

3. **高亮句子功能測試** 
   - 問題：DOM操作和事件處理難以在jsdom環境中完全模擬
   - 解決方向：可能需要使用真實瀏覽器環境或更複雜的模擬

### PDFHighlighter組件

1. **文本搜索與高亮邏輯測試**
   - 問題：測試在嘗試多次尋找文本時超時
   - 解決方向：已簡化為基本功能測試，但需要更完整測試高亮邏輯

2. **延遲渲染及異步操作測試**
   - 問題：多次嘗試查找DOM元素的測試不穩定
   - 解決方向：更好的定時器和DOM變更模擬

### PDFPreviewModal組件

1. **模態框與文件信息請求測試**
   - 問題：fetch模擬方法錯誤
   - 解決方向：與PDFViewer相同的fetch模擬方法

## 端到端測試

1. **實際PDF渲染與交互測試**
   - 問題：需要真實運行的應用服務器
   - 解決方向：手動啟動開發服務器，或配置專門的測試環境

2. **句子引用跳轉與高亮測試**
   - 問題：需要完整的應用流程（登入、聊天、點擊引用）
   - 解決方向：建立測試專用的模擬數據和API endpoints

## 視覺回歸測試

1. **跨瀏覽器渲染一致性測試**
   - 問題：需要在多個瀏覽器中運行，並保存基準截圖
   - 解決方向：使用GitHub Actions或其他CI服務配置多平台測試

2. **PDF高亮視覺效果測試**
   - 問題：視覺效果在模擬環境中難以測試
   - 解決方向：需在各主要瀏覽器中進行手動測試並記錄結果

## 性能測試

1. **PDF渲染性能指標收集**
   - 問題：需要真實環境下測量大文件渲染性能
   - 解決方向：使用Performance API和自定義計時器

2. **頁面切換和高亮響應時間測試**
   - 問題：需要精確測量操作響應時間
   - 解決方向：實現基準測試工具，收集不同大小PDF的性能數據

## 下一步計劃

1. 修復單元測試環境中的模擬問題，專注於核心功能測試
2. 實現最關鍵端到端測試的自動化流程
3. 建立視覺回歸測試的基準圖像
4. 開發性能測試工具和基準 